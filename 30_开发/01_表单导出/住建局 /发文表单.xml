<Template>
  <Messages>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <MessageTitle>发文表单</MessageTitle>
    <MessageCreateTime>2019/6/18 14:06:10</MessageCreateTime>
    <MessageFinishTime>2019/5/9 18:38:49</MessageFinishTime>
    <MessageTimeLimit></MessageTimeLimit>
    <MessageFinishTimeExpected>2019/5/9 18:38:49</MessageFinishTimeExpected>
    <MessageIssuedBy>100001</MessageIssuedBy>
    <MessageNote></MessageNote>
    <InitNodeKey>NODE0001</InitNodeKey>
    <MessageStatus>0</MessageStatus>
    <IsTemplate>1</IsTemplate>
    <MessageType>file</MessageType>
    <MessageTypeKey>发文表单</MessageTypeKey>
    <MessageHelper></MessageHelper>
    <FromTemplate></FromTemplate>
    <DataSourceID></DataSourceID>
  </Messages>
  <Nodes>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0001</NodeKey>
    <NodeName>签发</NodeName>
    <NodeStatus>0</NodeStatus>
    <NodeType>1</NodeType>
    <NodeDescr></NodeDescr>
    <HandlerAddress>appl</HandlerAddress>
    <HandlerID></HandlerID>
    <InTime>2019/5/9 18:39:05</InTime>
    <OutTime>2019/5/9 18:39:05</OutTime>
    <TimeLimit></TimeLimit>
    <OutTimeExpected>2999/12/31 0:00:00</OutTimeExpected>
    <SendMode>0</SendMode>
    <MultiHandleMode>0</MultiHandleMode>
    <MultiProcessMode>0</MultiProcessMode>
    <EntrustBy></EntrustBy>
    <ExpireProcess></ExpireProcess>
    <NodeCondition></NodeCondition>
    <NodeComment></NodeComment>
    <ReportToManager>0</ReportToManager>
    <NodePass></NodePass>
    <NodeOptions>{"SendSignConfig":{"AllowSendSign":"0"}}</NodeOptions>
    <SubflowConfig></SubflowConfig>
    <NeedSign>0</NeedSign>
  </Nodes>
  <Nodes>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0002</NodeKey>
    <NodeName>拟办</NodeName>
    <NodeStatus>0</NodeStatus>
    <NodeType>2</NodeType>
    <NodeDescr></NodeDescr>
    <HandlerAddress>pos:,01c01034-9cbc-4ae5-8cee-114d36a0bd3e,</HandlerAddress>
    <HandlerID></HandlerID>
    <InTime>2019/5/9 18:39:24</InTime>
    <OutTime>2019/5/9 18:39:24</OutTime>
    <TimeLimit></TimeLimit>
    <OutTimeExpected>2999/12/31 0:00:00</OutTimeExpected>
    <SendMode>1</SendMode>
    <MultiHandleMode>0</MultiHandleMode>
    <MultiProcessMode>1</MultiProcessMode>
    <EntrustBy></EntrustBy>
    <ExpireProcess></ExpireProcess>
    <NodeCondition></NodeCondition>
    <NodeComment></NodeComment>
    <ReportToManager>0</ReportToManager>
    <NodePass></NodePass>
    <NodeOptions>{"SendSignConfig":{"AllowSendSign":"0"}}</NodeOptions>
    <SubflowConfig></SubflowConfig>
    <NeedSign>0</NeedSign>
  </Nodes>
  <Nodes>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0003</NodeKey>
    <NodeName>会签</NodeName>
    <NodeStatus>0</NodeStatus>
    <NodeType>2</NodeType>
    <NodeDescr></NodeDescr>
    <HandlerAddress>dynamic</HandlerAddress>
    <HandlerID></HandlerID>
    <InTime>2019/5/9 18:39:38</InTime>
    <OutTime>2019/5/9 18:39:38</OutTime>
    <TimeLimit></TimeLimit>
    <OutTimeExpected>2999/12/31 0:00:00</OutTimeExpected>
    <SendMode>0</SendMode>
    <MultiHandleMode>1</MultiHandleMode>
    <MultiProcessMode>1</MultiProcessMode>
    <EntrustBy></EntrustBy>
    <ExpireProcess></ExpireProcess>
    <NodeCondition></NodeCondition>
    <NodeComment></NodeComment>
    <ReportToManager>0</ReportToManager>
    <NodePass></NodePass>
    <NodeOptions>{"SendSignConfig":{"AllowSendSign":"0"}}</NodeOptions>
    <SubflowConfig></SubflowConfig>
    <NeedSign>0</NeedSign>
  </Nodes>
  <Nodes>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0004</NodeKey>
    <NodeName>主要领导审核</NodeName>
    <NodeStatus>0</NodeStatus>
    <NodeType>2</NodeType>
    <NodeDescr></NodeDescr>
    <HandlerAddress>dynamic</HandlerAddress>
    <HandlerID></HandlerID>
    <InTime>2019/5/9 18:39:55</InTime>
    <OutTime>2019/5/9 18:39:55</OutTime>
    <TimeLimit></TimeLimit>
    <OutTimeExpected>2999/12/31 0:00:00</OutTimeExpected>
    <SendMode>1</SendMode>
    <MultiHandleMode>1</MultiHandleMode>
    <MultiProcessMode>1</MultiProcessMode>
    <EntrustBy></EntrustBy>
    <ExpireProcess></ExpireProcess>
    <NodeCondition></NodeCondition>
    <NodeComment></NodeComment>
    <ReportToManager>0</ReportToManager>
    <NodePass></NodePass>
    <NodeOptions>{"SendSignConfig":{"AllowSendSign":"0"},"SendbackConfig":{"SendbackToLastNode":1,"SendbackThenFlow":1,"SendbackThenJumpThis":0,"SendbackCondition":"","SendbackHideSendByCondition":0,"SendbackWhenNoSendTarget":0}}</NodeOptions>
    <SubflowConfig></SubflowConfig>
    <NeedSign>0</NeedSign>
  </Nodes>
  <Nodes>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0005</NodeKey>
    <NodeName>归档</NodeName>
    <NodeStatus>0</NodeStatus>
    <NodeType>2</NodeType>
    <NodeDescr></NodeDescr>
    <HandlerAddress>pos:,6fe4992c-80ad-4445-988e-6a5cac25fec3,</HandlerAddress>
    <HandlerID></HandlerID>
    <InTime>2019/5/9 18:40:17</InTime>
    <OutTime>2019/5/9 18:40:17</OutTime>
    <TimeLimit></TimeLimit>
    <OutTimeExpected>2999/12/31 0:00:00</OutTimeExpected>
    <SendMode>0</SendMode>
    <MultiHandleMode>0</MultiHandleMode>
    <MultiProcessMode>1</MultiProcessMode>
    <EntrustBy></EntrustBy>
    <ExpireProcess></ExpireProcess>
    <NodeCondition></NodeCondition>
    <NodeComment></NodeComment>
    <ReportToManager>0</ReportToManager>
    <NodePass></NodePass>
    <NodeOptions>{"SendSignConfig":{"AllowSendSign":"0"}}</NodeOptions>
    <SubflowConfig></SubflowConfig>
    <NeedSign>0</NeedSign>
  </Nodes>
  <Nodes>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0006</NodeKey>
    <NodeName>结束</NodeName>
    <NodeStatus>0</NodeStatus>
    <NodeType>4</NodeType>
    <NodeDescr></NodeDescr>
    <HandlerAddress>appl</HandlerAddress>
    <HandlerID></HandlerID>
    <InTime>2019/5/9 18:40:29</InTime>
    <OutTime>2019/5/9 18:40:29</OutTime>
    <TimeLimit></TimeLimit>
    <OutTimeExpected>2999/12/31 0:00:00</OutTimeExpected>
    <SendMode>0</SendMode>
    <MultiHandleMode>0</MultiHandleMode>
    <MultiProcessMode>1</MultiProcessMode>
    <EntrustBy></EntrustBy>
    <ExpireProcess></ExpireProcess>
    <NodeCondition></NodeCondition>
    <NodeComment></NodeComment>
    <ReportToManager>0</ReportToManager>
    <NodePass></NodePass>
    <NodeOptions>{"SendSignConfig":{"AllowSendSign":"0"}}</NodeOptions>
    <SubflowConfig></SubflowConfig>
    <NeedSign>0</NeedSign>
  </Nodes>
  <Nodes>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0007</NodeKey>
    <NodeName>传阅申请人</NodeName>
    <NodeStatus>0</NodeStatus>
    <NodeType>5</NodeType>
    <NodeDescr></NodeDescr>
    <HandlerAddress>sameto:0d55bf97-b605-41e0-aed2-cd13fb77c48d,NODE0001</HandlerAddress>
    <HandlerID></HandlerID>
    <InTime>2019/5/24 9:12:57</InTime>
    <OutTime>2019/5/24 9:12:57</OutTime>
    <TimeLimit></TimeLimit>
    <OutTimeExpected>2999/12/31 0:00:00</OutTimeExpected>
    <SendMode>0</SendMode>
    <MultiHandleMode>0</MultiHandleMode>
    <MultiProcessMode>1</MultiProcessMode>
    <EntrustBy></EntrustBy>
    <ExpireProcess></ExpireProcess>
    <NodeCondition></NodeCondition>
    <NodeComment></NodeComment>
    <ReportToManager>0</ReportToManager>
    <NodePass></NodePass>
    <NodeOptions>{"SendSignConfig":{"AllowSendSign":"0"}}</NodeOptions>
    <SubflowConfig></SubflowConfig>
    <NeedSign>0</NeedSign>
  </Nodes>
  <Nodes>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0008</NodeKey>
    <NodeName>传阅拟办节点</NodeName>
    <NodeStatus>0</NodeStatus>
    <NodeType>5</NodeType>
    <NodeDescr></NodeDescr>
    <HandlerAddress>sameto:0d55bf97-b605-41e0-aed2-cd13fb77c48d,NODE0002</HandlerAddress>
    <HandlerID></HandlerID>
    <InTime>2019/5/24 9:13:17</InTime>
    <OutTime>2019/5/24 9:13:17</OutTime>
    <TimeLimit></TimeLimit>
    <OutTimeExpected>2999/12/31 0:00:00</OutTimeExpected>
    <SendMode>0</SendMode>
    <MultiHandleMode>0</MultiHandleMode>
    <MultiProcessMode>1</MultiProcessMode>
    <EntrustBy></EntrustBy>
    <ExpireProcess></ExpireProcess>
    <NodeCondition></NodeCondition>
    <NodeComment></NodeComment>
    <ReportToManager>0</ReportToManager>
    <NodePass></NodePass>
    <NodeOptions>{"SendSignConfig":{"AllowSendSign":"0"}}</NodeOptions>
    <SubflowConfig></SubflowConfig>
    <NeedSign>0</NeedSign>
  </Nodes>
  <Nodes>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0009</NodeKey>
    <NodeName>部门审核</NodeName>
    <NodeStatus>0</NodeStatus>
    <NodeType>2</NodeType>
    <NodeDescr></NodeDescr>
    <HandlerAddress>dynamic</HandlerAddress>
    <HandlerID></HandlerID>
    <InTime>2019/6/18 13:29:59</InTime>
    <OutTime>2019/6/18 13:29:59</OutTime>
    <TimeLimit></TimeLimit>
    <OutTimeExpected>2999/12/31 0:00:00</OutTimeExpected>
    <SendMode>0</SendMode>
    <MultiHandleMode>0</MultiHandleMode>
    <MultiProcessMode>1</MultiProcessMode>
    <EntrustBy></EntrustBy>
    <ExpireProcess></ExpireProcess>
    <NodeCondition></NodeCondition>
    <NodeComment></NodeComment>
    <ReportToManager>0</ReportToManager>
    <NodePass></NodePass>
    <NodeOptions>{"SendSignConfig":{"AllowSendSign":"0"}}</NodeOptions>
    <SubflowConfig></SubflowConfig>
    <NeedSign>0</NeedSign>
  </Nodes>
  <NodeLayout>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0001</NodeKey>
    <X>80</X>
    <Y>180</Y>
  </NodeLayout>
  <NodeLayout>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0002</NodeKey>
    <X>280</X>
    <Y>180</Y>
  </NodeLayout>
  <NodeLayout>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0003</NodeKey>
    <X>280</X>
    <Y>80</Y>
  </NodeLayout>
  <NodeLayout>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0004</NodeKey>
    <X>380</X>
    <Y>180</Y>
  </NodeLayout>
  <NodeLayout>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0005</NodeKey>
    <X>480</X>
    <Y>180</Y>
  </NodeLayout>
  <NodeLayout>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0006</NodeKey>
    <X>580</X>
    <Y>180</Y>
  </NodeLayout>
  <NodeLayout>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0007</NodeKey>
    <X>380</X>
    <Y>280</Y>
  </NodeLayout>
  <NodeLayout>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0008</NodeKey>
    <X>580</X>
    <Y>280</Y>
  </NodeLayout>
  <NodeLayout>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0009</NodeKey>
    <X>180</X>
    <Y>180</Y>
  </NodeLayout>
  <NodeField>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0009</NodeKey>
    <DocID>bd5ec40d-2b29-4805-8975-440db67fcabc</DocID>
    <FieldKey>D10</FieldKey>
    <Control>2</Control>
  </NodeField>
  <NodeField>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0002</NodeKey>
    <DocID>bd5ec40d-2b29-4805-8975-440db67fcabc</DocID>
    <FieldKey>D12</FieldKey>
    <Control>2</Control>
  </NodeField>
  <NodeField>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0003</NodeKey>
    <DocID>bd5ec40d-2b29-4805-8975-440db67fcabc</DocID>
    <FieldKey>D14</FieldKey>
    <Control>2</Control>
  </NodeField>
  <NodeField>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0004</NodeKey>
    <DocID>bd5ec40d-2b29-4805-8975-440db67fcabc</DocID>
    <FieldKey>D16</FieldKey>
    <Control>2</Control>
  </NodeField>
  <NodeField>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0001</NodeKey>
    <DocID>bd5ec40d-2b29-4805-8975-440db67fcabc</DocID>
    <FieldKey>D4</FieldKey>
    <Control>2</Control>
  </NodeField>
  <NodeField>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0001</NodeKey>
    <DocID>bd5ec40d-2b29-4805-8975-440db67fcabc</DocID>
    <FieldKey>D5</FieldKey>
    <Control>2</Control>
  </NodeField>
  <NodeField>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0001</NodeKey>
    <DocID>bd5ec40d-2b29-4805-8975-440db67fcabc</DocID>
    <FieldKey>D6</FieldKey>
    <Control>2</Control>
  </NodeField>
  <NodeField>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0001</NodeKey>
    <DocID>bd5ec40d-2b29-4805-8975-440db67fcabc</DocID>
    <FieldKey>D7</FieldKey>
    <Control>2</Control>
  </NodeField>
  <NodeField>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0001</NodeKey>
    <DocID>bd5ec40d-2b29-4805-8975-440db67fcabc</DocID>
    <FieldKey>D8</FieldKey>
    <Control>2</Control>
  </NodeField>
  <NodeField>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0001</NodeKey>
    <DocID>bd5ec40d-2b29-4805-8975-440db67fcabc</DocID>
    <FieldKey>D9</FieldKey>
    <Control>2</Control>
  </NodeField>
  <NodeField>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0009</NodeKey>
    <DocID>bd5ec40d-2b29-4805-8975-440db67fcabc</DocID>
    <FieldKey>F11</FieldKey>
    <Control>1</Control>
  </NodeField>
  <NodeField>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0002</NodeKey>
    <DocID>bd5ec40d-2b29-4805-8975-440db67fcabc</DocID>
    <FieldKey>F13</FieldKey>
    <Control>1</Control>
  </NodeField>
  <NodeField>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0003</NodeKey>
    <DocID>bd5ec40d-2b29-4805-8975-440db67fcabc</DocID>
    <FieldKey>F15</FieldKey>
    <Control>1</Control>
  </NodeField>
  <NodeField>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0004</NodeKey>
    <DocID>bd5ec40d-2b29-4805-8975-440db67fcabc</DocID>
    <FieldKey>F17</FieldKey>
    <Control>1</Control>
  </NodeField>
  <NodeField>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0001</NodeKey>
    <DocID>bd5ec40d-2b29-4805-8975-440db67fcabc</DocID>
    <FieldKey>I4</FieldKey>
    <Control>2</Control>
  </NodeField>
  <NodeField>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0001</NodeKey>
    <DocID>bd5ec40d-2b29-4805-8975-440db67fcabc</DocID>
    <FieldKey>I5</FieldKey>
    <Control>2</Control>
  </NodeField>
  <NodeField>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0001</NodeKey>
    <DocID>bd5ec40d-2b29-4805-8975-440db67fcabc</DocID>
    <FieldKey>I6</FieldKey>
    <Control>2</Control>
  </NodeField>
  <NodeField>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0001</NodeKey>
    <DocID>bd5ec40d-2b29-4805-8975-440db67fcabc</DocID>
    <FieldKey>I7</FieldKey>
    <Control>2</Control>
  </NodeField>
  <NodeField>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0009</NodeKey>
    <DocID>bd5ec40d-2b29-4805-8975-440db67fcabc</DocID>
    <FieldKey>J11</FieldKey>
    <Control>1</Control>
  </NodeField>
  <NodeField>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0002</NodeKey>
    <DocID>bd5ec40d-2b29-4805-8975-440db67fcabc</DocID>
    <FieldKey>J13</FieldKey>
    <Control>1</Control>
  </NodeField>
  <NodeAction>
    <NodeActionID>27039</NodeActionID>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0001</NodeKey>
    <NodeActionName>映射表数据</NodeActionName>
    <NodeActionNo>0</NodeActionNo>
    <NodeActionOccur>3</NodeActionOccur>
    <NodeActionCommand>execurl:/Apps/DEP/Workflow/MappingData</NodeActionCommand>
    <NodeActionCommandRoleback></NodeActionCommandRoleback>
    <NodeActionResult>0</NodeActionResult>
    <NodeActionResultRoleback>0</NodeActionResultRoleback>
    <CreateTime>2019/5/13 17:19:33</CreateTime>
  </NodeAction>
  <NodePath>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0001</NodeKey>
    <TargetNodeKey>NODE0009</TargetNodeKey>
    <NodePathType>0</NodePathType>
    <NodePathStatus>0</NodePathStatus>
    <NodePathFinishTime>2019/6/18 13:29:59</NodePathFinishTime>
    <NodePathTarget></NodePathTarget>
    <NodePathName></NodePathName>
    <NodePathCondition></NodePathCondition>
  </NodePath>
  <NodePath>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0002</NodeKey>
    <TargetNodeKey>NODE0003</TargetNodeKey>
    <NodePathType>0</NodePathType>
    <NodePathStatus>0</NodePathStatus>
    <NodePathFinishTime>2019/5/18 14:06:00</NodePathFinishTime>
    <NodePathTarget></NodePathTarget>
    <NodePathName></NodePathName>
    <NodePathCondition></NodePathCondition>
  </NodePath>
  <NodePath>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0002</NodeKey>
    <TargetNodeKey>NODE0004</TargetNodeKey>
    <NodePathType>0</NodePathType>
    <NodePathStatus>0</NodePathStatus>
    <NodePathFinishTime>2019/5/20 14:13:47</NodePathFinishTime>
    <NodePathTarget></NodePathTarget>
    <NodePathName></NodePathName>
    <NodePathCondition></NodePathCondition>
  </NodePath>
  <NodePath>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0003</NodeKey>
    <TargetNodeKey>NODE0002</TargetNodeKey>
    <NodePathType>0</NodePathType>
    <NodePathStatus>0</NodePathStatus>
    <NodePathFinishTime>2019/5/20 14:13:41</NodePathFinishTime>
    <NodePathTarget></NodePathTarget>
    <NodePathName></NodePathName>
    <NodePathCondition></NodePathCondition>
  </NodePath>
  <NodePath>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0004</NodeKey>
    <TargetNodeKey>NODE0005</TargetNodeKey>
    <NodePathType>0</NodePathType>
    <NodePathStatus>0</NodePathStatus>
    <NodePathFinishTime>2019/5/9 18:40:17</NodePathFinishTime>
    <NodePathTarget></NodePathTarget>
    <NodePathName></NodePathName>
    <NodePathCondition></NodePathCondition>
  </NodePath>
  <NodePath>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0005</NodeKey>
    <TargetNodeKey>NODE0006</TargetNodeKey>
    <NodePathType>0</NodePathType>
    <NodePathStatus>0</NodePathStatus>
    <NodePathFinishTime>2019/5/9 18:40:29</NodePathFinishTime>
    <NodePathTarget></NodePathTarget>
    <NodePathName></NodePathName>
    <NodePathCondition></NodePathCondition>
  </NodePath>
  <NodePath>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0005</NodeKey>
    <TargetNodeKey>NODE0007</TargetNodeKey>
    <NodePathType>0</NodePathType>
    <NodePathStatus>0</NodePathStatus>
    <NodePathFinishTime>2019/5/24 9:12:57</NodePathFinishTime>
    <NodePathTarget></NodePathTarget>
    <NodePathName></NodePathName>
    <NodePathCondition></NodePathCondition>
  </NodePath>
  <NodePath>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0005</NodeKey>
    <TargetNodeKey>NODE0008</TargetNodeKey>
    <NodePathType>0</NodePathType>
    <NodePathStatus>0</NodePathStatus>
    <NodePathFinishTime>2019/5/24 9:13:17</NodePathFinishTime>
    <NodePathTarget></NodePathTarget>
    <NodePathName></NodePathName>
    <NodePathCondition></NodePathCondition>
  </NodePath>
  <NodePath>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0009</NodeKey>
    <TargetNodeKey>NODE0001</TargetNodeKey>
    <NodePathType>0</NodePathType>
    <NodePathStatus>0</NodePathStatus>
    <NodePathFinishTime>2019/6/18 13:35:11</NodePathFinishTime>
    <NodePathTarget></NodePathTarget>
    <NodePathName></NodePathName>
    <NodePathCondition>发文表单.D10='不同意'</NodePathCondition>
  </NodePath>
  <NodePath>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <NodeKey>NODE0009</NodeKey>
    <TargetNodeKey>NODE0002</TargetNodeKey>
    <NodePathType>0</NodePathType>
    <NodePathStatus>0</NodePathStatus>
    <NodePathFinishTime>2019/6/18 13:30:03</NodePathFinishTime>
    <NodePathTarget></NodePathTarget>
    <NodePathName></NodePathName>
    <NodePathCondition>发文表单.D10='同意'</NodePathCondition>
  </NodePath>
  <Doc>
    <DocID>bd5ec40d-2b29-4805-8975-440db67fcabc</DocID>
    <MessageID>0d55bf97-b605-41e0-aed2-cd13fb77c48d</MessageID>
    <DocName>发文表单</DocName>
    <DocType>spreadsheet</DocType>
    <DocDescr></DocDescr>
    <DocHelperID>e4cd8041-f9cd-46a9-b0ad-71e5aa5ca8d6</DocHelperID>
    <DocContent></DocContent>
  </Doc>
  <Worksheets>
    <WorksheetID>e4cd8041-f9cd-46a9-b0ad-71e5aa5ca8d6</WorksheetID>
    <WorksheetName>发文表单</WorksheetName>
    <WorkbookID>0</WorkbookID>
    <CheckOut></CheckOut>
    <CreateTime>2019/5/9 18:40:58</CreateTime>
    <UpdateTime>2019/6/18 14:16:07</UpdateTime>
    <RowHeight>2,58;4,52;5,49;6,48;7,49;8,51;9,55;10,124;11,45;12,193;13,41;14,178;15,42;16,189;17,42</RowHeight>
    <ColWidth>1,59;2,69;3,63;4,94;5,99;6,92;8,65;9,92;10,113;11,117</ColWidth>
    <Document>&lt;Table&gt;&lt;Row Index="2" Size="58" /&gt;&lt;Row Index="4" Size="52" /&gt;&lt;Row Index="5" Size="49" /&gt;&lt;Row Index="6" Size="48" /&gt;&lt;Row Index="7" Size="49" /&gt;&lt;Row Index="8" Size="51" /&gt;&lt;Row Index="9" Size="55" /&gt;&lt;Row Index="10" Size="124" /&gt;&lt;Row Index="11" Size="45" /&gt;&lt;Row Index="12" Size="193" /&gt;&lt;Row Index="13" Size="41" /&gt;&lt;Row Index="14" Size="178" /&gt;&lt;Row Index="15" Size="42" /&gt;&lt;Row Index="16" Size="189" /&gt;&lt;Row Index="17" Size="42" /&gt;&lt;Column Index="1" Size="59" /&gt;&lt;Column Index="2" Size="69" /&gt;&lt;Column Index="3" Size="63" /&gt;&lt;Column Index="4" Size="94" /&gt;&lt;Column Index="5" Size="99" /&gt;&lt;Column Index="6" Size="92" /&gt;&lt;Column Index="8" Size="65" /&gt;&lt;Column Index="9" Size="92" /&gt;&lt;Column Index="10" Size="113" /&gt;&lt;Column Index="11" Size="117" /&gt;&lt;CellEvent Row="15" Col="6" EventOn="OnUpdate" EventCommand="javascript:opinionChanged('#C-15-6');" /&gt;&lt;CellEvent Row="17" Col="6" EventOn="OnUpdate" EventCommand="javascript:opinionChanged('#C-17-6');" /&gt;&lt;CellEvent Row="17" Col="6" EventOn="OnDblClick" EventCommand="" /&gt;&lt;Cell Col="2" Row="2" MergeToCol="11" FontName="方正小标宋简体" FontSize="24" Align="2" Value="发文表单" /&gt;&lt;Cell Col="2" Row="4" MergeToCol="3" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="方正小标宋简体" FontSize="16" Align="2" Value="发文编号" /&gt;&lt;Cell Col="7" Row="4" MergeToCol="8" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontSize="16" FontName="方正小标宋简体" Align="2" Value="发文日期" /&gt;&lt;Cell Col="2" Row="5" MergeToCol="3" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="方正小标宋简体" FontSize="16" Align="2" Value="发文类型" /&gt;&lt;Cell Col="7" Row="5" MergeToCol="8" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontSize="16" FontName="方正小标宋简体" Align="2" Value="文号" /&gt;&lt;Cell Col="2" Row="6" MergeToCol="3" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="方正小标宋简体" FontSize="16" Align="2" Value="密级" /&gt;&lt;Cell Col="7" Row="6" MergeToCol="8" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontSize="16" FontName="方正小标宋简体" Align="2" Value="紧急程度" /&gt;&lt;Cell Col="2" Row="7" MergeToCol="3" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="方正小标宋简体" FontSize="16" Align="2" Value="保管期限" /&gt;&lt;Cell Col="7" Row="7" MergeToCol="8" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontSize="16" FontName="方正小标宋简体" Align="2" Value="归档类目" /&gt;&lt;Cell Col="2" Row="8" MergeToCol="3" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="方正小标宋简体" FontSize="16" Align="2" Value="文件标题" /&gt;&lt;Cell Col="2" Row="9" MergeToCol="3" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="方正小标宋简体" FontSize="16" Align="2" Value="正文" /&gt;&lt;Cell Col="2" Row="12" MergeToCol="3" MergeToRow="13" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="方正小标宋简体" FontSize="16" Align="2" Value="拟办" /&gt;&lt;Cell Col="4" Row="13" MergeToCol="5" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontSize="16" FontName="方正小标宋简体" Align="2" Value="签办人" /&gt;&lt;Cell Col="2" Row="14" MergeToCol="3" MergeToRow="15" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="方正小标宋简体" FontSize="16" Align="2" Value="会签" /&gt;&lt;Cell Col="4" Row="15" MergeToCol="5" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontSize="16" FontName="方正小标宋简体" Align="2" Value="常用意见模板" /&gt;&lt;Cell Col="2" Row="16" MergeToCol="3" MergeToRow="17" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="方正小标宋简体" FontSize="16" Align="2" Value="主要领导&amp;#xA;审核" /&gt;&lt;Cell Col="4" Row="17" MergeToCol="5" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="方正小标宋简体" FontSize="16" Align="2" Value="常用意见模板" /&gt;&lt;Cell Col="4" Row="4" MergeToCol="6" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="仿宋_GB2312" FontSize="14" /&gt;&lt;Cell Col="9" Row="4" MergeToCol="11" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" BackColor="" FontSize="14" FontName="仿宋_GB2312" DSValues="yyyy-mm-dd,@" DataSource="3" /&gt;&lt;Cell Col="4" Row="5" MergeToCol="6" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="仿宋_GB2312" FontSize="14" DSValues="局党组发文单&amp;#xA;住房和城乡建设局发文单&amp;#xA;无锡市新吴区重点建设项目管理中心&amp;#xA;行政管理建议书&amp;#xA;行政告诫书&amp;#xA;行政处罚事先告知书&amp;#xA;新区管委会会议纪要&amp;#xA;环境违法行为限期整改通知单&amp;#xA;村庄整治办发文单&amp;#xA;行政约谈通知书&amp;#xA;新吴区交通干线整治办公室&amp;#xA;其他发文单&amp;#xA;建设环保局应急快报&amp;#xA;局党总支发文单" DataSource="1" /&gt;&lt;Cell Col="9" Row="5" MergeToCol="11" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontSize="14" FontName="仿宋_GB2312" /&gt;&lt;Cell Col="4" Row="6" MergeToCol="6" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="仿宋_GB2312" FontSize="14" DSValues="不涉密&amp;#xA;秘密&amp;#xA;机密&amp;#xA;绝密" DataSource="1" /&gt;&lt;Cell Col="9" Row="6" MergeToCol="11" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontSize="14" FontName="仿宋_GB2312" DSValues="普通&amp;#xA;紧急&amp;#xA;非常紧急" DataSource="1" /&gt;&lt;Cell Col="4" Row="7" MergeToCol="6" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="仿宋_GB2312" FontSize="14" DSValues="10年&amp;#xA;30年&amp;#xA;永久" DataSource="1" /&gt;&lt;Cell Col="9" Row="7" MergeToCol="11" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontSize="14" FontName="仿宋_GB2312" DSValues="省政府&amp;#xA;市委市政府&amp;#xA;市局文件&amp;#xA;区局文件&amp;#xA;内部发文&amp;#xA;其他" DataSource="1" /&gt;&lt;Cell Col="4" Row="8" MergeToCol="11" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="仿宋_GB2312" FontSize="14" /&gt;&lt;Cell Col="4" Row="9" MergeToCol="11" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="仿宋_GB2312" FontSize="14" DataSource="10" /&gt;&lt;Cell Col="4" Row="12" MergeToCol="11" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="仿宋_GB2312" FontSize="14" /&gt;&lt;Cell Col="6" Row="13" MergeToCol="7" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="仿宋_GB2312" FontSize="14" Align="2" DataSource="102" /&gt;&lt;Cell Col="10" Row="13" MergeToCol="11" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="仿宋_GB2312" FontSize="14" Align="2" DataSource="106" /&gt;&lt;Cell Col="4" Row="14" MergeToCol="11" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="仿宋_GB2312" FontSize="14" KeepHistory="true" /&gt;&lt;Cell Col="6" Row="15" MergeToCol="7" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="仿宋_GB2312" FontSize="14" DSValues="公共模板意见|Content|Content|Content" Align="2" DataSource="2" /&gt;&lt;Cell Col="10" Row="15" MergeToCol="11" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="仿宋_GB2312" FontSize="14" Align="2" /&gt;&lt;Cell Col="4" Row="16" MergeToCol="11" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="仿宋_GB2312" FontSize="14" KeepHistory="true" /&gt;&lt;Cell Col="6" Row="17" MergeToCol="7" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="仿宋_GB2312" FontSize="14" DSValues="公共模板意见|Content|Content|Content" Align="2" DataSource="2" /&gt;&lt;Cell Col="10" Row="17" MergeToCol="11" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="仿宋_GB2312" FontSize="14" Align="2" /&gt;&lt;Cell Col="8" Row="13" MergeToCol="9" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontSize="16" FontName="方正小标宋简体" Align="2" Value="签办日期" /&gt;&lt;Cell Col="8" Row="15" MergeToCol="9" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontName="方正小标宋简体" FontSize="16" Align="2" Value="个人意见模板" /&gt;&lt;Cell Col="8" Row="17" MergeToCol="9" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontSize="16" FontName="方正小标宋简体" Align="2" Value="个人意见模板" /&gt;&lt;Cell Col="11" Row="1" BackColor="FFFFFF" /&gt;&lt;Cell Col="2" Row="10" MergeToCol="3" MergeToRow="11" FontName="方正小标宋简体" FontSize="16" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" Align="2" Value="部门审核" /&gt;&lt;Cell Col="4" Row="11" MergeToCol="5" FontSize="16" FontName="方正小标宋简体" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" Align="2" Value="签办人" /&gt;&lt;Cell Col="6" Row="11" MergeToCol="7" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontSize="14" FontName="仿宋_GB2312" Align="2" DataSource="102" /&gt;&lt;Cell Col="8" Row="11" MergeToCol="9" FontSize="16" FontName="方正小标宋简体" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" Align="2" Value="签办日期" /&gt;&lt;Cell Col="10" Row="11" MergeToCol="11" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontSize="14" FontName="仿宋_GB2312" Align="2" DataSource="106" /&gt;&lt;Cell Col="4" Row="10" MergeToCol="11" BorderTopWidth="1" BorderRightWidth="1" BorderBottomWidth="1" BorderLeftWidth="1" FontSize="14" FontName="仿宋_GB2312" DSValues="同意&amp;#xA;不同意" DataSource="1" /&gt;&lt;/Table&gt;</Document>
    <DataStorage>&lt;Data&gt;&lt;DataSource Name="公共模板意见" Connstr="137数据库" Sql="SELECT ID, Content FROM TGR_PublicOpinion;" /&gt;&lt;/Data&gt;</DataStorage>
    <Script>/*******************************************************************
 * 住建局发文表单
 ******************************************************************/

function onSheetLoad() {
    // 样式先载入
    AddCustomCss();

    // 功能定制跟进
    loadScripts(["/Apps/DEP/Content/sdk/sdk.js"], function(){
        main();
    });
};

function onSheetCheck() {
};

function onAnyCellUpdate() {
};

// 每个表单的定制入口
function main() {
    /*
     * 参数获取
     */
    // 获取节点ID
    var nid = getQueryString("nid");
    //当没有节点Id 所以处于只读状态 初始化按钮
    var MessageID = getQueryString("mid");
    // 领导的节点，自定义按钮
    var isWkfRunnign = IsWkfRunning();

    if(isWkfRunnign){
        /*
         * 动作改造
         */
        // 覆盖默认保存草稿操作
        onSaveDraft();

        // 个人意见修改
        GetOpinionConfig(MessageID, nid);

        if(nid === 'NODE0001'){
            options = [
                {'content': '中共无锡市委'},
                {'content': '中共无锡市委办公室'},
                {'content': '无锡市人民政府'},
                {'content': '无锡市人民政府办公室'},
                {'content': '中共江苏省委'},
                {'content': '中共江苏省委办公厅'},
                {'content': '江苏省人民政府'},
                {'content': '江苏省人民政府办公厅'},
                {'content': '中共中央国务院'},
                {'content': '江苏省物价局 江苏调查总队'},
                {'content': '无锡市河长制工作办公室'},
                {'content': '无锡市太湖蓝藻打捞工作协调小组办公室'},
                {'content': '省大气污染防治联席会议办公室'},
                {'content': '无锡市环境保护委员会办公室'},
                {'content': '无锡市太湖水污染防治办公室'}
            ]
            // 定制显示来文单位
            ShowUnitList("unit", "636px", "231px", "323px", "54px", "55px", options, '#C-5-9', '#C-5-9', null);
        }

        if (nid === 'NODE0002' || nid === 'NODE0005') {
            // 正文编辑按钮
            addEditDocButton(worksheet_id);
        }
    }
    $("#tbSheet").show();
}

/******************************************************************
 * 工具方法 【必须】
 * ****************************************************************/
function loadScripts(array,callback){
    var loader = function(src,handler){
        var script = document.createElement("script");
        script.src = src;
        script.onload = script.onreadystatechange = function(){
            script.onreadystatechange = script.onload = null;
            handler();
        }
        var head = document.getElementsByTagName("head")[0];
        (head || document.body).appendChild( script );
    };
    (function run(){
        if(array.length!=0){
            loader(array.shift(), run);
        }else{
            callback &amp;&amp; callback();
        }
    })();
}

// 通用样式修改
function AddCustomCss() {
    // 修复弹出框被文件选择框挡住的问题
    // .DropDown ul {font-size:12px;}
    var styleTag = $('&lt;style&gt;.DropDown { z-index: 999; } .my-niban-opinion a, .my-opinion a {display:inline-block; margin-right: 10px;border: 1px solid #337ab7;font-size: 13px;padding: 3px 5px;margin-bottom: 10px;margin-left:15px;} .my-niban-opinion textarea, .my-opinion textarea { margin-top: 3px;margin-left: 15px;} #receiveNo &gt; ul &gt; li:hover,div#unit &gt; ul &gt; li:hover {background: rgb(207,229,239);}&lt;/style&gt;')

    $('html &gt; head').append(styleTag);
    // 表单居中
    $("#tbSheet").hide();
    $("#tbSheet").css('margin-left', '-71px');
    $("#page").css('display', 'flex');
    $("#page").css('width', '100%');
    $("#page").css('height', '100%');
    $("#page").css('justify-content', 'center');
}



// TODO：放到sdk.js中去
function addEditDocButton(worksheet_id) {
    // 自定义顶部按钮
    var title_bar = $('#titlebar &gt; ul', top.document);

    // 创建已阅按钮
    var edit_li = document.createElement('LI');
    var edit_button = document.createElement('BUTTON');
    edit_button.setAttribute("id", "btn-custom-read");
    edit_button.onclick = function () {
        GetCellAttachment(worksheet_id, 9, 4, WindowsOpenDoc);
    };
    var i = document.createElement('I');
    i.className = 'fa fa-edit';
    i.textContent = ' 正文编辑';
    edit_button.appendChild(i);
    edit_li.appendChild(edit_button);

    title_bar.prepend(edit_li);
}

/*
 * 获取公文指定位置的附件列表
 */
function GetCellAttachment(sid, row, col, callback) {
    $.ajax({
        url: '/Apps/DEP/Common/CellAttachment?sid=' + sid + '&amp;row=' + row + '&amp;col=' + col,
        type: 'GET',
        success: function(data) {
            console.log(data)
            if (data.Succeed) {
                attachment_list = data.Data.attachments;
                if (attachment_list.length == 1) {
                    var session = getCookie('APPKIZTICKET');
                    var origin = location.origin;
                    var attachment = attachment_list[0];
                    callback &amp;&amp; callback(origin, session, attachment, row, col);
                } else {
                    alert('附件个数不为1，无法正文编辑');
                }
            }
            else
            {
                console.log(data.Message)
            }
        },
        error: function(error) {
            console.log(error)
        }
    })
}

function WindowsOpenDoc(origin, session, attachment, row, col) {
    var att_id = attachment.AttID;

    $.ajax({
        url: 'http://127.0.0.1:5000/openDoc',
        type: 'POST',
        data: {
            'origin': origin,
            'session': session,
            'att_id': attachment.AttID,
            'extension': attachment.AttExtension,
            'row': row,
            'col': col
        },
        success: function(data) {
            console.log(data)
            if (data.code == 200) {
                // 开始轮询，是否已经编辑上传
                CheckAttachmentStatus(att_id);
            } else {
                console.log(data)
                alert(data.message)
            }
        },
        error:function(error){
            console.log(error);
            alert('请确认"公文编辑助手"已打开')
        }
    })
}

function CheckAttachmentStatus(att_id) {
    var interval = window.setInterval(function(){
        $.ajax({
            url: 'http://127.0.0.1:5000/status/' + att_id,
            type: 'GET',
            success: function(data) {
                if (data.code == 200) {
                    // 附件已经上传，询问是否刷新页面
                    if (window.confirm('检测到附件更新，是否刷新页面？')) {
                        // 停止轮询，并刷新页面
                        clearInterval(interval);
                        // YES
                        top.window.location.reload();
                    } else {
                        // NO
                        // just stay
                        console.log('用户取消了刷新页面')
                    }
                } else if (data.code == 203) {
                    // 用户未更新文档，保持不动
                    console.log(data)
                    clearInterval(interval);
                } else if (data.code == 400){
                    // 附件已经上传，询问是否刷新页面
                    if (window.confirm('提示：' + data.message)) {
                        // 停止轮询，并刷新页面
                        clearInterval(interval);
                        // YES
                        top.window.location.reload();
                    } else {
                        // NO
                        // 停止轮询，并刷新页面
                        clearInterval(interval);
                        // YES
                        top.window.location.reload();
                        console.log('用户取消了刷新页面')
                    }
                } else {
                    // 附件未上传，一直询问
                    console.log(data)
                }
            },
            error: function(error) {
                console.log(error);
            }
        })
    }, 1000, att_id);
    
}
/*
 * 工具类
 */
function getCookie(name) {
    var match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
    if (match) return match[2];
}</Script>
  </Worksheets>
</Template>